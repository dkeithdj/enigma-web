---
import Layout from "@/layouts/Layout.astro";
import { getPost, getPosts } from "@/utils/sanity/client";
import type { InferGetStaticParamsType } from "astro";
import { PortableText } from "../../components/portabletext";

export async function getStaticPaths() {
  const posts = await getPosts();
  return posts.map((post) => ({
    params: { slug: post.slug.current },
  }));
  // return [{ params: { slug: "event-1" } }];
}

type Params = InferGetStaticParamsType<typeof getStaticPaths>;
const { slug } = Astro.params as Params;

const post = await getPost(slug);
---

<Layout title=`${post.title}`>
  <section class="">
    <div>
      {post.mainImage ? <img src={`${post.mainImage}`} /> : ""}
      <h1>{post.title}</h1>
    </div>
    <div class="prose">
      <PortableText value={post.body} />
    </div>
  </section>
</Layout>
